/* ==========================================================================
   MainScreen Layout

   Responsive layout with sidebar and main content area.
   - Mobile (<640px): Sidebar slides in as overlay
   - Tablet (640-767px): Navbar visible, content panel as overlay
   - Desktop (768px+): Full sidebar + main content side by side
   ========================================================================== */

.main-screen {
  --header-height: 50px;
  --nav-width: 72px;
  --sidebar-slide-offset: 30px;

  display: flex;
  height: 100%;
  position: relative;
}

/* ==========================================================================
   Sidebar
   ========================================================================== */

.sidebar {
  display: flex;
  flex-shrink: 0;
}

.sidebar__nav {
  display: flex;
  flex-direction: column;
  width: var(--nav-width);
  flex-shrink: 0;
  background: var(--surface);
  border-right: 1px solid var(--border);
}

.sidebar__nav-top,
.sidebar__nav-bottom {
  display: flex;
  flex-direction: column;
  align-items: center;
  flex-shrink: 0;
}

.sidebar__nav-bottom {
  padding-bottom: 12px;
}

.sidebar__nav-scroll-wrapper {
  flex: 1;
  min-height: 0;
  display: flex;
  flex-direction: column;
}

.sidebar__nav-scroll {
  flex: 1;
  min-height: 0;
}

.sidebar__nav-rooms {
  display: flex;
  flex-direction: column;
  align-items: center;
}

.sidebar__content {
  position: relative;
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
  background: var(--surface);
}

.sidebar__resize-handle {
  display: none;
}

.sidebar__header {
  height: var(--header-height);
  flex-shrink: 0;
  border-block: 1px solid var(--border);
}

.sidebar__body {
  flex: 1;
  min-height: 0;
}

/* ==========================================================================
   Main Content
   ========================================================================== */

.main-content {
  display: flex;
  flex-direction: column;
  flex: 1;
  min-width: 0;
  background: var(--background);
}

.main-content__header {
  display: flex;
  height: var(--header-height);
  flex-shrink: 0;
  border-block: 1px solid var(--border);
  background: var(--background);
}

.main-content__menu-button {
  display: none;
}

.main-content__header-content {
  flex: 1;
  min-width: 0;
}

.main-content__body {
  flex: 1;
  min-height: 0;
}

/* ==========================================================================
   Responsive: Mobile (<640px) - Sidebar as full overlay
   ========================================================================== */

@media (max-width: 639px) {
  .sidebar {
    position: absolute;
    inset: 0 auto 0 0;
    width: 100%;
    z-index: 30;
    pointer-events: none;
  }

  .sidebar--open,
  .sidebar--dm-empty {
    pointer-events: auto;
  }

  .sidebar__nav {
    transform: translateX(calc(-1 * var(--nav-width)));
    transition: transform 0.3s ease-out 0.2s;
  }

  .sidebar--open .sidebar__nav,
  .sidebar--dm-empty .sidebar__nav {
    transform: none;
    transition: transform 0.3s ease-out;
  }

  .sidebar__content {
    opacity: 0;
    transform: translateX(calc(-1 * var(--sidebar-slide-offset)));
    transition:
      opacity 0.2s ease-out,
      transform 0.2s ease-out;
  }

  .sidebar--open .sidebar__content,
  .sidebar--dm-empty .sidebar__content {
    opacity: 1;
    transform: none;
    transition:
      opacity 0.25s ease-out 0.2s,
      transform 0.25s ease-out 0.2s;
  }

  .main-content__menu-button {
    display: flex;
    width: var(--header-height);
    height: var(--header-height);
    flex-shrink: 0;
    border-radius: 0;
  }

  /* Hide main content when DMs are empty on mobile */
  .sidebar--dm-empty ~ .main-content {
    display: none;
  }
}

/* ==========================================================================
   Responsive: Tablet (640-767px) - Navbar visible, content as overlay
   ========================================================================== */

@media (min-width: 640px) and (max-width: 767px) {
  .sidebar__content {
    position: absolute;
    left: var(--nav-width);
    right: 0;
    top: 0;
    bottom: 0;
    opacity: 0;
    pointer-events: none;
    transform: translateX(calc(-1 * var(--sidebar-slide-offset)));
    transition:
      opacity 0.2s ease-out,
      transform 0.2s ease-out;
  }

  .sidebar--open .sidebar__content,
  .sidebar--dm-empty .sidebar__content {
    opacity: 1;
    pointer-events: auto;
    transform: none;
    transition:
      opacity 0.25s ease-out,
      transform 0.25s ease-out;
  }

  /* Hide main content when DMs are empty on tablet */
  .sidebar--dm-empty ~ .main-content {
    display: none;
  }
}

/* ==========================================================================
   Responsive: Desktop (768px+) - Sidebar and main content side by side
   ========================================================================== */

@media (min-width: 768px) {
  .sidebar__content {
    flex: none;
  }

  .sidebar__resize-handle {
    display: flex;
    align-items: center;
    justify-content: center;
    position: absolute;
    top: 0;
    bottom: 0;
    right: -6px;
    width: 6px;
    cursor: col-resize;
    z-index: 10;
  }

  .sidebar__resize-handle::after {
    content: "";
    width: 2px;
    height: 60px;
    background: var(--border);
    border-radius: 2px;
  }

  .sidebar__resize-handle:not(.sidebar__resize-handle--active):hover::after {
    background: var(--accent);
  }

  .sidebar__resize-handle--active {
    background: var(--accent);
  }

  .sidebar__resize-handle--active::after {
    background: var(--surface);
  }
}
